<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LocalServer-API 接口文档</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans SC', sans-serif;
            background-color: #111827;
            color: #d1d5db;
        }
        /* 自定义滚动条样式 */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1f2937;
        }
        ::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
        h2 {
            font-size: 1.875rem; /* 30px */
            line-height: 2.25rem; /* 36px */
            font-weight: 700;
            padding-bottom: 0.5rem;
            margin-top: 2.5rem;
            border-bottom: 1px solid #374151;
        }
        h3 {
            font-size: 1.5rem; /* 24px */
            line-height: 2rem; /* 32px */
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        pre {
            background-color: #1f2937;
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            color: #e5e7eb;
            font-family: 'Menlo', 'Consolas', monospace;
        }
        code:not(pre > code) {
            background-color: #374151;
            color: #f3f4f6;
            padding: 0.2em 0.4em;
            margin: 0;
            font-size: 85%;
            border-radius: 6px;
        }
        table {
            width: 100%;
            margin-top: 1rem;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #374151;
            padding: 0.75rem 1rem;
            text-align: left;
        }
        th {
            background-color: #1f2937;
            font-weight: 600;
        }
        a {
            color: #60a5fa;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body class="flex min-h-screen">
    <!-- Sidebar Navigation -->
    <aside class="w-1/4 max-w-xs h-screen sticky top-0 p-8 border-r border-gray-800 hidden md:block overflow-y-auto">
        <h1 class="text-2xl font-bold text-white mb-6">API 文档</h1>
        <nav>
            <ul class="space-y-3">
                <li><a href="#overview" class="font-semibold text-lg hover:text-white">1. 概述</a></li>
                <li><a href="#authentication" class="font-semibold text-lg hover:text-white">2. 认证</a></li>
                <li><a href="#conventions" class="font-semibold text-lg hover:text-white">3. 通用约定</a></li>
                <li>
                    <a href="#endpoints" class="font-semibold text-lg hover:text-white">4. API 端点详解</a>
                    <ul class="ml-4 mt-2 space-y-2 border-l border-gray-700 pl-4">
                        <li><a href="#ep-status" class="hover:text-white">4.1 状态检查</a></li>
                        <li><a href="#ep-create" class="hover:text-white">4.2 创建笔记</a></li>
                        <li><a href="#ep-read" class="hover:text-white">4.3 读取笔记</a></li>
                        <li><a href="#ep-update" class="hover:text-white">4.4 更新笔记</a></li>
                        <li><a href="#ep-delete" class="hover:text-white">4.5 删除笔记</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="w-full md:w-3/4 p-6 md:p-10 lg:p-12 overflow-y-auto">
        <header class="mb-10">
            <h1 class="text-4xl font-bold text-white">LocalServer-API 接口文档 (v1.0)</h1>
            <p class="mt-2 text-lg text-gray-400">欢迎使用 LocalServer-API for Obsidian！本 API 允许您通过编程方式，安全地与您的 Obsidian知识库进行交互，实现对笔记的创建、读取、更新和删除（CRUD）操作。</p>
        </header>

        <section id="overview">
            <h2>1. 概述 (Overview)</h2>
            <h3>基础 URL (Base URL)</h3>
            <p>所有 API 请求都应发送到以下基础 URL：</p>
            <pre><code>http://localhost:&lt;PORT&gt;</code></pre>
            <ul class="list-disc list-inside mt-4 space-y-2">
                <li><code>&lt;PORT&gt;</code>: 这是 Obsidian 用户在 LocalServer-API 插件设置中配置的端口号。默认值为 <code>8888</code>。请提醒您的应用用户，需要从他们的插件设置中获取实际的端口号。</li>
            </ul>

            <h3>数据格式 (Data Format)</h3>
            <p>所有请求体（Request Body）和响应体（Response Body）都使用 <code>application/json</code> 格式。发送数据的请求（<code>POST</code>, <code>PUT</code>）必须包含 <code>Content-Type: application/json</code> 的请求头。</p>
        </section>

        <section id="authentication">
            <h2>2. 认证 (Authentication)</h2>
            <p>本 API 使用 <strong>Bearer Token</strong> 方案进行安全认证。</p>
            <ol class="list-decimal list-inside mt-4 space-y-2">
                <li><strong>获取 API Key</strong>: API Key 由 Obsidian 用户在 <code>LocalServer API</code> 插件的设置页面中生成和获取。它是一个长而随机的字符串。</li>
                <li><strong>发送认证信息</strong>: 开发者在调用所有受保护的 API 端点时，必须在 HTTP 请求头中加入 <code>Authorization</code> 字段。</li>
            </ol>
            <p class="mt-4"><strong>格式</strong>:</p>
            <pre><code>Authorization: Bearer &lt;用户的API_KEY&gt;</code></pre>
            <p class="mt-4">如果认证失败（未提供、格式错误或Key不正确），服务器将返回 <code>401 Unauthorized</code> 错误。</p>
        </section>

        <section id="conventions">
            <h2>3. 通用约定 (General Conventions)</h2>
            <h3>URL 编码</h3>
            <p>当文件路径包含非英文字符（如中文、日文）、空格或特殊符号时，必须在作为URL查询参数（Query Parameter）传递前进行 <strong>URL 编码</strong>。</p>
            <h3>错误响应格式</h3>
            <p>所有错误响应都遵循统一的JSON格式，并包含一个 <code>message</code> 字段以说明错误原因。</p>
            <p class="mt-4"><strong>示例</strong>:</p>
            <pre><code>{
  "message": "Not Found: File with path '...' does not exist."
}</code></pre>
        </section>

        <section id="endpoints">
            <h2>4. API 端点详解 (API Endpoints)</h2>

            <article id="ep-status" class="mt-8">
                <h3>4.1 状态检查</h3>
                <p>此端点用于检查 API 服务器是否正在运行，无需认证。</p>
                <div class="mt-4 p-4 border border-gray-700 rounded-lg">
                    <p><span class="font-bold text-green-400">GET</span> <code>/status</code></p>
                    <p class="mt-2"><strong class="text-gray-400">认证:</strong> 否</p>
                    <p class="mt-4"><strong>成功响应 (Code: <code>200 OK</code>):</strong></p>
                    <pre><code>{
  "status": "ok",
  "message": "LocalServer-API is running"
}</code></pre>
                    <p class="mt-4"><strong>示例 <code>curl</code> 命令:</strong></p>
                    <pre><code>curl http://localhost:8888/status</code></pre>
                </div>
            </article>

            <article id="ep-create" class="mt-8">
                <h3>4.2 创建笔记</h3>
                <p>在Obsidian知识库中创建一个新的笔记。</p>
                <div class="mt-4 p-4 border border-gray-700 rounded-lg">
                    <p><span class="font-bold text-blue-400">POST</span> <code>/note</code></p>
                    <p class="mt-2"><strong class="text-gray-400">认证:</strong> 是</p>
                    <p class="mt-4"><strong>请求体 (JSON):</strong></p>
                    <table>
                        <thead>
                            <tr><th>字段名</th><th>类型</th><th>是否必须</th><th>描述</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><code>path</code></td><td>string</td><td>是</td><td>笔记的完整路径，包含文件夹和<code>.md</code>后缀。例如: <code>Work/Meetings/2025-08-06 会议纪要.md</code></td></tr>
                            <tr><td><code>content</code></td><td>string</td><td>是</td><td>笔记的初始内容，支持Markdown语法。</td></tr>
                        </tbody>
                    </table>
                    <p class="mt-4"><strong>成功响应 (Code: <code>201 Created</code>):</strong></p>
                    <pre><code>{
  "message": "Note '...' created successfully."
}</code></pre>
                    <p class="mt-4"><strong>示例 <code>curl</code> 命令:</strong></p>
                    <pre><code>curl -X POST http://localhost:8888/note \
     -H "Content-Type: application/json" \
     -H "Authorization: Bearer &lt;用户的API_KEY&gt;" \
     -d '{
       "path": "API测试/我的第一个笔记.md",
       "content": "# 欢迎\n\n这是通过API创建的内容。"
     }'</code></pre>
                </div>
            </article>

            <article id="ep-read" class="mt-8">
                <h3>4.3 读取笔记</h3>
                <p>读取指定路径笔记的完整内容。</p>
                <div class="mt-4 p-4 border border-gray-700 rounded-lg">
                    <p><span class="font-bold text-green-400">GET</span> <code>/note</code></p>
                    <p class="mt-2"><strong class="text-gray-400">认证:</strong> 是</p>
                    <p class="mt-4"><strong>查询参数:</strong></p>
                    <table>
                        <thead>
                            <tr><th>参数名</th><th>类型</th><th>是否必须</th><th>描述</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><code>path</code></td><td>string</td><td>是</td><td>要读取笔记的完整路径。<strong>必须进行URL编码</strong>。</td></tr>
                        </tbody>
                    </table>
                    <p class="mt-4"><strong>成功响应 (Code: <code>200 OK</code>):</strong></p>
                    <pre><code>{
  "path": "API测试/我的第一个笔记.md",
  "content": "# 欢迎\n\n这是通过API创建的内容。"
}</code></pre>
                    <p class="mt-4"><strong>示例 <code>curl</code> 命令:</strong></p>
                    <pre><code># 假设文件名为 "API测试/我的第一个笔记.md", URL编码后为 "API%E6%B5%8B%E8%AF%95%2F%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%AC%94%E8%AE%B0.md"
curl -X GET "http://localhost:8888/note?path=..." \
     -H "Authorization: Bearer &lt;用户的API_KEY&gt;"</code></pre>
                </div>
            </article>

            <article id="ep-update" class="mt-8">
                <h3>4.4 更新笔记</h3>
                <p>用新内容<strong>完全覆盖</strong>一个已存在的笔记。</p>
                <div class="mt-4 p-4 border border-gray-700 rounded-lg">
                    <p><span class="font-bold text-yellow-400">PUT</span> <code>/note</code></p>
                    <p class="mt-2"><strong class="text-gray-400">认证:</strong> 是</p>
                    <p class="mt-4"><strong>请求体 (JSON):</strong></p>
                    <table>
                        <thead>
                            <tr><th>字段名</th><th>类型</th><th>是否必须</th><th>描述</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><code>path</code></td><td>string</td><td>是</td><td>要更新笔记的完整路径。</td></tr>
                            <tr><td><code>content</code></td><td>string</td><td>是</td><td>将完全覆盖旧内容的<strong>新内容</strong>。</td></tr>
                        </tbody>
                    </table>
                    <p class="mt-4"><strong>成功响应 (Code: <code>200 OK</code>):</strong></p>
                    <pre><code>{
  "message": "Note '...' updated successfully."
}</code></pre>
                    <p class="mt-4"><strong>示例 <code>curl</code> 命令:</strong></p>
                    <pre><code>curl -X PUT http://localhost:8888/note \
     -H "Content-Type: application/json" \
     -H "Authorization: Bearer &lt;用户的API_KEY&gt;" \
     -d '{
       "path": "API测试/我的第一个笔记.md",
       "content": "# 更新后的标题\n\n内容已被覆盖。"
     }'</code></pre>
                </div>
            </article>

            <article id="ep-delete" class="mt-8">
                <h3>4.5 删除笔记</h3>
                <p><strong>永久删除</strong>一个指定的笔记。</p>
                <div class="mt-4 p-4 border border-gray-700 rounded-lg">
                    <p><span class="font-bold text-red-400">DELETE</span> <code>/note</code></p>
                    <p class="mt-2"><strong class="text-gray-400">认证:</strong> 是</p>
                    <p class="mt-4"><strong>查询参数:</strong></p>
                    <table>
                        <thead>
                            <tr><th>参数名</th><th>类型</th><th>是否必须</th><th>描述</th></tr>
                        </thead>
                        <tbody>
                            <tr><td><code>path</code></td><td>string</td><td>是</td><td>要删除笔记的完整路径。<strong>必须进行URL编码</strong>。</td></tr>
                        </tbody>
                    </table>
                    <p class="mt-4"><strong>成功响应 (Code: <code>200 OK</code>):</strong></p>
                    <pre><code>{
  "message": "Note '...' deleted successfully."
}</code></pre>
                    <p class="mt-4"><strong>示例 <code>curl</code> 命令:</strong></p>
                    <pre><code>curl -X DELETE "http://localhost:8888/note?path=..." \
     -H "Authorization: Bearer &lt;用户的API_KEY&gt;"</code></pre>
                </div>
            </article>
        </section>
    </main>
</body>
</html>
